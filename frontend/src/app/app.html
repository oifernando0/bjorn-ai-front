<main class="page">
  <section class="hero">
    <div>
      <p class="eyebrow">Bjorn AI</p>
      <h1>Converse com o seu assistente</h1>
      <p class="subtitle">
        Envie uma mensagem para o backend do Bjorn AI e visualize a resposta sem sair do navegador.
      </p>
    </div>
    <div class="pill">Backend configurável em <code>src/environments/environment.ts</code></div>
  </section>

  <section class="card">
    <form class="form" (ngSubmit)="onSubmit()" novalidate>
      <label for="message">Mensagem</label>
      <textarea
        id="message"
        name="message"
        [formControl]="messageControl"
        placeholder="Ex.: Olá Bjorn, quais são minhas tarefas de hoje?"
        rows="4"
        [attr.aria-invalid]="messageControl.invalid"
      ></textarea>

      <div class="helper">
        <span *ngIf="messageControl.invalid && (messageControl.touched || messageControl.dirty)">
          A mensagem é obrigatória e deve ter no máximo 500 caracteres.
        </span>
        <span class="status" [class.loading]="isSending()">
          {{ isSending() ? 'Enviando...' : 'Pronto para enviar' }}
        </span>
      </div>

      <button type="submit" [disabled]="!canSubmit">Enviar mensagem</button>
    </form>

    <div class="feedback" *ngIf="error() as errorMessage">
      <p>⚠️ {{ errorMessage }}</p>
    </div>

    <div class="chat" *ngIf="history().length; else emptyState">
      <div class="entry" *ngFor="let item of history()" [class.user]="item.role === 'user'">
        <span class="role">{{ item.role === 'user' ? 'Você' : 'Bjorn' }}</span>
        <p>{{ item.text }}</p>
      </div>
    </div>
    <ng-template #emptyState>
      <div class="empty">
        <p>Envie sua primeira mensagem para iniciar a conversa.</p>
      </div>
    </ng-template>
  </section>
</main>
